<div class="step-text">
<h5 id="description">Description</h5>
<p>You have created an API that displays user-created tasks. If you want to add, update, or delete any task, you need to login into your <code class="language-json">superuser</code> account and carry out the tasks from the Django admin panel. It's tedious and inconvenient.</p>
<p>With the help of the API, you should be able to add, update and delete tasks, not only view them. In this stage, you will implement the CRUD functionality in the project that gives access to the app through <code class="language-json">GET</code> requests to <code class="language-json">POST</code>, <code class="language-json">PUT</code>, <code class="language-json">PATCH</code>, and <code class="language-json">DELETE</code>. <strong>CRUD </strong>stands for Create, Read, Update, and Delete, representing the four basic operations performed on database records or data. The <code class="language-json">POST</code> request adds new data. <code class="language-json">PUT</code> and <code class="language-json">PATCH</code> update it. <code class="language-json">DELETE</code>, just like the name suggests, deletes the data. We can implement this functionality by making simple tweaks in <code class="language-json">views</code> from the previous stage. </p>
<p>If you look at your project closely, you'll see that anyone can access endpoints. After implementing the CRUD functionality, they can add data, which may lead to spam and trolling. To resolve this, we need to incorporate permissions so that only the registered users can work with the endpoints. You can either write a custom permission class or change the project permission in <em>settings.py</em>. It is a good practice to write custom permission, but since your project has only one API app, you can change the permissions from the settings (Project Level Permissions). You can find more about it in the <a href="https://www.django-rest-framework.org/tutorial/4-authentication-and-permissions/#object-level-permissions" rel="noopener noreferrer nofollow" target="_blank">REST Framework</a> documentation.</p>
<h5 id="objectives">Objectives</h5>
<p>Add a new field in the model that stores the user's ID that created the task. We cannot allow anyone to change the task content of other users, so you need to create a relation between the task and the user. Your API should display all the content to registered users only; reserve the <code class="language-json">delete</code> and <code class="language-json">update</code> functionality to the author of the task.</p>
<p></p><div class="alert alert-warning">In other words, anyone could access the endpoints in the previous stage. After implementing the permission, if an unregistered user tries to access the data, the response at <code class="language-json">localhost:8000/api/tasks/</code> should be <code class="language-json">403 Forbidden</code>.</div>
<p>Like in the previous stage, you can communicate with the API with the different requests. We will run the server to see how they work at once. </p>
<p>You should also add a login to the browsable API. Use <code class="language-json">api-auth</code> for this purpose. It creates a login link on the top right of the page. You can find more about it in the <a href="https://www.django-rest-framework.org/tutorial/4-authentication-and-permissions/#adding-login-to-the-browsable-api" rel="noopener noreferrer nofollow" target="_blank">REST Framework</a> documentation.</p>
<p>Summing up, to pass this stage, you need to:</p>
<ul>
<li>Add permissions so that only the registered users can use the API;</li>
<li>Add more users from the Django admin portal;</li>
<li>Implement the CRUD functionality in the project;</li>
<li>Only the task author can update and delete a task; other registered users can view it, non-registered users should not be able to see any tasks.</li>
</ul>
<h5 id="examples">Examples</h5>
<p><strong>Example 1: </strong><em>response for unregistered users on localhost:8000/api/tasks/.</em></p>
<pre><code class="language-json">HTTP 403 Forbidden
Allow: GET, POST, HEAD, OPTIONS
Content-Type: application/json
Vary: Accept

{
    "detail": "Authentication credentials were not provided."
}</code></pre>
<p><strong>Example 2:</strong> <em>localhost:8000/api/tasks/ in a browser.</em></p>
<p style="text-align: center;"><picture><source media="(max-width: 480px)" srcset="https://ucarecdn.com/0a7020dc-a323-4245-89a0-c7afc8a75845/-/stretch/off/-/resize/480x/-/format/webp/ 1x,https://ucarecdn.com/0a7020dc-a323-4245-89a0-c7afc8a75845/-/stretch/off/-/resize/960x/-/format/webp/ 2x,https://ucarecdn.com/0a7020dc-a323-4245-89a0-c7afc8a75845/-/stretch/off/-/resize/1440x/-/format/webp/ 3x" type="image/webp"/><source media="(max-width: 800px)" srcset="https://ucarecdn.com/0a7020dc-a323-4245-89a0-c7afc8a75845/-/stretch/off/-/resize/800x/-/format/webp/ 1x,https://ucarecdn.com/0a7020dc-a323-4245-89a0-c7afc8a75845/-/stretch/off/-/resize/1600x/-/format/webp/ 2x,https://ucarecdn.com/0a7020dc-a323-4245-89a0-c7afc8a75845/-/stretch/off/-/resize/2400x/-/format/webp/ 3x" type="image/webp"/><source srcset="https://ucarecdn.com/0a7020dc-a323-4245-89a0-c7afc8a75845/-/stretch/off/-/resize/1100x/-/format/webp/ 1x,https://ucarecdn.com/0a7020dc-a323-4245-89a0-c7afc8a75845/-/stretch/off/-/resize/2200x/-/format/webp/ 2x,https://ucarecdn.com/0a7020dc-a323-4245-89a0-c7afc8a75845/-/stretch/off/-/resize/3000x/-/format/webp/ 3x" type="image/webp"/><img alt="" height="448" name="image.png" src="https://ucarecdn.com/0a7020dc-a323-4245-89a0-c7afc8a75845/" width="767"/></picture></p>
<p>Note that the registered users can access the endpoint as before. Also, notice a Login link in the top right corner. It displays the username of the logged-in user. You can log out using the same link.</p>
<p><strong>Example 3: </strong><em>response on localhost:8000/api/tasks/ after logging in and adding one task.</em></p>
<pre><code class="language-json">HTTP 200 OK
Allow: GET, POST, HEAD, OPTIONS
Content-Type: application/json
Vary: Accept

[
    {
        "id": 1,
        "task": "task",
        "description": "Recently added task",
        "goal_set_date": "2022-01-11",
        "set_to_complete": "2022-01-20",
        "is_completed": false,
        "todo_of": 1
    }
]</code></pre>
<p><strong>Example 4: </strong><em>localhost:8000/api/tasks/ in a browser.</em></p>
<p style="text-align: center;"><picture><source media="(max-width: 480px)" srcset="https://ucarecdn.com/88bc0432-6108-4e73-bcb6-3f8f519c3b7d/-/stretch/off/-/resize/480x/-/format/webp/ 1x,https://ucarecdn.com/88bc0432-6108-4e73-bcb6-3f8f519c3b7d/-/stretch/off/-/resize/960x/-/format/webp/ 2x,https://ucarecdn.com/88bc0432-6108-4e73-bcb6-3f8f519c3b7d/-/stretch/off/-/resize/1440x/-/format/webp/ 3x" type="image/webp"/><source media="(max-width: 800px)" srcset="https://ucarecdn.com/88bc0432-6108-4e73-bcb6-3f8f519c3b7d/-/stretch/off/-/resize/800x/-/format/webp/ 1x,https://ucarecdn.com/88bc0432-6108-4e73-bcb6-3f8f519c3b7d/-/stretch/off/-/resize/1600x/-/format/webp/ 2x,https://ucarecdn.com/88bc0432-6108-4e73-bcb6-3f8f519c3b7d/-/stretch/off/-/resize/2400x/-/format/webp/ 3x" type="image/webp"/><source srcset="https://ucarecdn.com/88bc0432-6108-4e73-bcb6-3f8f519c3b7d/-/stretch/off/-/resize/1100x/-/format/webp/ 1x,https://ucarecdn.com/88bc0432-6108-4e73-bcb6-3f8f519c3b7d/-/stretch/off/-/resize/2200x/-/format/webp/ 2x,https://ucarecdn.com/88bc0432-6108-4e73-bcb6-3f8f519c3b7d/-/stretch/off/-/resize/3000x/-/format/webp/ 3x" type="image/webp"/><img alt="" height="547" name="image.png" src="https://ucarecdn.com/88bc0432-6108-4e73-bcb6-3f8f519c3b7d/" width="774"/></picture></p>
<p><strong>Example 5:</strong> <em>localhost:8000/api/tasks/ in a browser. Note the Log out button.</em></p>
<p style="text-align: center;"><picture><source media="(max-width: 480px)" srcset="https://ucarecdn.com/dfee52ac-aa46-498e-9014-543b3b793e56/-/stretch/off/-/resize/480x/-/format/webp/ 1x,https://ucarecdn.com/dfee52ac-aa46-498e-9014-543b3b793e56/-/stretch/off/-/resize/960x/-/format/webp/ 2x,https://ucarecdn.com/dfee52ac-aa46-498e-9014-543b3b793e56/-/stretch/off/-/resize/1440x/-/format/webp/ 3x" type="image/webp"/><source media="(max-width: 800px)" srcset="https://ucarecdn.com/dfee52ac-aa46-498e-9014-543b3b793e56/-/stretch/off/-/resize/800x/-/format/webp/ 1x,https://ucarecdn.com/dfee52ac-aa46-498e-9014-543b3b793e56/-/stretch/off/-/resize/1600x/-/format/webp/ 2x,https://ucarecdn.com/dfee52ac-aa46-498e-9014-543b3b793e56/-/stretch/off/-/resize/2400x/-/format/webp/ 3x" type="image/webp"/><source srcset="https://ucarecdn.com/dfee52ac-aa46-498e-9014-543b3b793e56/-/stretch/off/-/resize/1100x/-/format/webp/ 1x,https://ucarecdn.com/dfee52ac-aa46-498e-9014-543b3b793e56/-/stretch/off/-/resize/2200x/-/format/webp/ 2x,https://ucarecdn.com/dfee52ac-aa46-498e-9014-543b3b793e56/-/stretch/off/-/resize/3000x/-/format/webp/ 3x" type="image/webp"/><img alt="" height="519" name="image.png" src="https://ucarecdn.com/dfee52ac-aa46-498e-9014-543b3b793e56/" width="781"/></picture></p>
<p><strong>Example 6:</strong> <em>localhost:8000/api/tasks/ in a browser. There is a box right below the displayed data, from where you can add a new task to the database. Add two new data and see how your current data changes.</em></p>
<p style="text-align: center;"><picture><source media="(max-width: 480px)" srcset="https://ucarecdn.com/f2c4b229-a729-4805-ae1f-91f83c4ecb2a/-/stretch/off/-/resize/480x/-/format/webp/ 1x,https://ucarecdn.com/f2c4b229-a729-4805-ae1f-91f83c4ecb2a/-/stretch/off/-/resize/960x/-/format/webp/ 2x,https://ucarecdn.com/f2c4b229-a729-4805-ae1f-91f83c4ecb2a/-/stretch/off/-/resize/1440x/-/format/webp/ 3x" type="image/webp"/><source media="(max-width: 800px)" srcset="https://ucarecdn.com/f2c4b229-a729-4805-ae1f-91f83c4ecb2a/-/stretch/off/-/resize/800x/-/format/webp/ 1x,https://ucarecdn.com/f2c4b229-a729-4805-ae1f-91f83c4ecb2a/-/stretch/off/-/resize/1600x/-/format/webp/ 2x,https://ucarecdn.com/f2c4b229-a729-4805-ae1f-91f83c4ecb2a/-/stretch/off/-/resize/2400x/-/format/webp/ 3x" type="image/webp"/><source srcset="https://ucarecdn.com/f2c4b229-a729-4805-ae1f-91f83c4ecb2a/-/stretch/off/-/resize/1100x/-/format/webp/ 1x,https://ucarecdn.com/f2c4b229-a729-4805-ae1f-91f83c4ecb2a/-/stretch/off/-/resize/2200x/-/format/webp/ 2x,https://ucarecdn.com/f2c4b229-a729-4805-ae1f-91f83c4ecb2a/-/stretch/off/-/resize/3000x/-/format/webp/ 3x" type="image/webp"/><img alt="" height="578" name="image.png" src="https://ucarecdn.com/f2c4b229-a729-4805-ae1f-91f83c4ecb2a/" width="760"/></picture></p>
<p>Here, <em><strong>Todo of </strong></em>is the author user who will be writing the todo.</p>
<p><strong>Example 7:</strong> <em>Response for registered users for the localhost:8000/api/tasks/1 route.</em></p>
<pre><code class="language-json">HTTP 200 OK
Allow: GET, PUT, PATCH, DELETE, HEAD, OPTIONS
Content-Type: application/json
Vary: Accept

{
    "id": 1,
    "task": "task",
    "description": "Recently added task",
    "goal_set_date": "2022-01-11",
    "set_to_complete": "2022-01-20",
    "is_completed": false,
    "todo_of": 1
}</code></pre>
<p><strong>Example 8: </strong><em>Browsable api at localhost:8000/api/tasks/1 after login</em>. <em>If you go to the detailed view of the latest task you added at localhost:8000/api/tasks/&lt;id&gt;/ you will see something like this:</em></p>
<p style="text-align: center;"><picture><source media="(max-width: 480px)" srcset="https://ucarecdn.com/e5c8e685-c9e4-4005-b2fb-8facd784885a/-/stretch/off/-/resize/480x/-/format/webp/ 1x,https://ucarecdn.com/e5c8e685-c9e4-4005-b2fb-8facd784885a/-/stretch/off/-/resize/960x/-/format/webp/ 2x,https://ucarecdn.com/e5c8e685-c9e4-4005-b2fb-8facd784885a/-/stretch/off/-/resize/1440x/-/format/webp/ 3x" type="image/webp"/><source media="(max-width: 800px)" srcset="https://ucarecdn.com/e5c8e685-c9e4-4005-b2fb-8facd784885a/-/stretch/off/-/resize/800x/-/format/webp/ 1x,https://ucarecdn.com/e5c8e685-c9e4-4005-b2fb-8facd784885a/-/stretch/off/-/resize/1600x/-/format/webp/ 2x,https://ucarecdn.com/e5c8e685-c9e4-4005-b2fb-8facd784885a/-/stretch/off/-/resize/2400x/-/format/webp/ 3x" type="image/webp"/><source srcset="https://ucarecdn.com/e5c8e685-c9e4-4005-b2fb-8facd784885a/-/stretch/off/-/resize/1100x/-/format/webp/ 1x,https://ucarecdn.com/e5c8e685-c9e4-4005-b2fb-8facd784885a/-/stretch/off/-/resize/2200x/-/format/webp/ 2x,https://ucarecdn.com/e5c8e685-c9e4-4005-b2fb-8facd784885a/-/stretch/off/-/resize/3000x/-/format/webp/ 3x" type="image/webp"/><img alt="" height="497" name="image.png" src="https://ucarecdn.com/e5c8e685-c9e4-4005-b2fb-8facd784885a/" width="747"/></picture></p>
<p><strong>Example 9: </strong><em>Browsable api at localhost:8000/api/tasks/1 after login</em>, (box right below the displayed data for editing tasks, method PUT)</p>
<p style="text-align: center;"><picture><source media="(max-width: 480px)" srcset="https://ucarecdn.com/5f02715b-dbaa-4e07-951d-1d5145e548a1/-/stretch/off/-/resize/480x/-/format/webp/ 1x,https://ucarecdn.com/5f02715b-dbaa-4e07-951d-1d5145e548a1/-/stretch/off/-/resize/960x/-/format/webp/ 2x,https://ucarecdn.com/5f02715b-dbaa-4e07-951d-1d5145e548a1/-/stretch/off/-/resize/1440x/-/format/webp/ 3x" type="image/webp"/><source media="(max-width: 800px)" srcset="https://ucarecdn.com/5f02715b-dbaa-4e07-951d-1d5145e548a1/-/stretch/off/-/resize/800x/-/format/webp/ 1x,https://ucarecdn.com/5f02715b-dbaa-4e07-951d-1d5145e548a1/-/stretch/off/-/resize/1600x/-/format/webp/ 2x,https://ucarecdn.com/5f02715b-dbaa-4e07-951d-1d5145e548a1/-/stretch/off/-/resize/2400x/-/format/webp/ 3x" type="image/webp"/><source srcset="https://ucarecdn.com/5f02715b-dbaa-4e07-951d-1d5145e548a1/-/stretch/off/-/resize/1100x/-/format/webp/ 1x,https://ucarecdn.com/5f02715b-dbaa-4e07-951d-1d5145e548a1/-/stretch/off/-/resize/2200x/-/format/webp/ 2x,https://ucarecdn.com/5f02715b-dbaa-4e07-951d-1d5145e548a1/-/stretch/off/-/resize/3000x/-/format/webp/ 3x" type="image/webp"/><img alt="" height="481" name="image.png" src="https://ucarecdn.com/5f02715b-dbaa-4e07-951d-1d5145e548a1/" width="738"/></picture></p>
<p>Here you will also see similar boxes as before, but these will update the task of <code class="language-json">&lt;id&gt;</code> you have requested. You will also notice a DELETE button that deletes the task. If you are not logged in as the owner of the task, you will still be able to see the task, but won't be able to perform Delete and Update operations.</p>
<p><strong>Example 10: </strong><em>Browsable api at localhost:8000/api/tasks/1 without logging in.</em></p>
<p style="text-align: center;"><picture><source media="(max-width: 480px)" srcset="https://ucarecdn.com/467999fa-df99-4e32-bb6a-f3369ed0adba/-/stretch/off/-/resize/480x/-/format/webp/ 1x,https://ucarecdn.com/467999fa-df99-4e32-bb6a-f3369ed0adba/-/stretch/off/-/resize/960x/-/format/webp/ 2x,https://ucarecdn.com/467999fa-df99-4e32-bb6a-f3369ed0adba/-/stretch/off/-/resize/1440x/-/format/webp/ 3x" type="image/webp"/><source media="(max-width: 800px)" srcset="https://ucarecdn.com/467999fa-df99-4e32-bb6a-f3369ed0adba/-/stretch/off/-/resize/800x/-/format/webp/ 1x,https://ucarecdn.com/467999fa-df99-4e32-bb6a-f3369ed0adba/-/stretch/off/-/resize/1600x/-/format/webp/ 2x,https://ucarecdn.com/467999fa-df99-4e32-bb6a-f3369ed0adba/-/stretch/off/-/resize/2400x/-/format/webp/ 3x" type="image/webp"/><source srcset="https://ucarecdn.com/467999fa-df99-4e32-bb6a-f3369ed0adba/-/stretch/off/-/resize/1100x/-/format/webp/ 1x,https://ucarecdn.com/467999fa-df99-4e32-bb6a-f3369ed0adba/-/stretch/off/-/resize/2200x/-/format/webp/ 2x,https://ucarecdn.com/467999fa-df99-4e32-bb6a-f3369ed0adba/-/stretch/off/-/resize/3000x/-/format/webp/ 3x" type="image/webp"/><img alt="Todo api: Browsable api at localhost:8000/api/tasks/1 without log in" height="445" name="image.png" src="https://ucarecdn.com/467999fa-df99-4e32-bb6a-f3369ed0adba/" width="760"/></picture></p>
</div>